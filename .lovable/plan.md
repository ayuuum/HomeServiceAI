
# LINEé€£æºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç°¡ç´ åŒ–ãƒ—ãƒ©ãƒ³

## ç¾çŠ¶ã®èª²é¡Œ

| å•é¡Œç‚¹ | è©³ç´° |
|--------|------|
| é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«æ“ä½œ | ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä½œæˆã€ãƒãƒ£ãƒãƒ«ä½œæˆï¼ˆ2ç¨®é¡ï¼‰ãŒå¿…è¦ |
| ã‚³ãƒ”ãƒšé …ç›®ãŒå¤šã„ | Token, Secret, LIFF ID, Webhook URLç­‰ |
| è¨­å®šæ¼ã‚ŒãŒç™ºç”Ÿã—ã‚„ã™ã„ | Webhookæ¤œè¨¼ã€åˆ©ç”¨ã‚¹ã‚¤ãƒƒãƒONç­‰ã®ç´°ã‹ã„æ‰‹é † |

## ç°¡ç´ åŒ–ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### æˆ¦ç•¥1: å¿…é ˆé …ç›®ã‚’æœ€å°åŒ–

**ç¾åœ¨ã®å…¥åŠ›é …ç›®ï¼ˆ6å€‹ï¼‰:**
- Channel Access Token â† å¿…é ˆ
- Channel Secret â† å¿…é ˆ
- Bot User ID â† **è‡ªå‹•å–å¾—å¯èƒ½**
- LIFF ID â† **ã‚ªãƒ—ã‚·ãƒ§ãƒ³åŒ–**
- Admin LINE User ID â† **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç™»éŒ²ã§è‡ªå‹•**
- Webhook URL â† **è¡¨ç¤ºã®ã¿ã€ã‚³ãƒ”ãƒ¼ç”¨**

**ç°¡ç´ åŒ–å¾Œã®å…¥åŠ›é …ç›®ï¼ˆ2å€‹ï¼‰:**
1. Channel Access Tokenï¼ˆé•·æœŸï¼‰
2. Channel Secret

### æˆ¦ç•¥2: ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰

ç¾åœ¨ã®1ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã€ã‚¬ã‚¤ãƒ‰ä»˜ãã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å½¢å¼ã«å¤‰æ›´:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LINEé€£æºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—                         â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ â— Step 1 â†’ â—‹ Step 2 â†’ â—‹ Step 3 â†’ â—‹ å®Œäº†    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ ğŸ“± Step 1: LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æº–å‚™          â”‚
â”‚                                             â”‚
â”‚ LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ           â”‚
â”‚                                             â”‚
â”‚ [ã¯ã„ã€æŒã£ã¦ã„ã¾ã™]  [ã„ã„ãˆã€ä½œæˆã—ã¾ã™]    â”‚
â”‚                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ’¡ LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç„¡æ–™ã§ä½œæˆã§ãã¾ã™    â”‚
â”‚    [LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãƒšãƒ¼ã‚¸ â†—]          â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã®å„ã‚¹ãƒ†ãƒƒãƒ—

**Step 1: LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¢ºèª**
- æŒã£ã¦ã„ã‚‹ â†’ Step 2ã¸
- æŒã£ã¦ã„ãªã„ â†’ ä½œæˆã‚¬ã‚¤ãƒ‰ãƒªãƒ³ã‚¯è¡¨ç¤º

**Step 2: Messaging APIæœ‰åŠ¹åŒ–**
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Messaging APIã‚’æœ‰åŠ¹ã«ã™ã‚‹            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ 1. LINE Official Account Managerã«ãƒ­ã‚°ã‚¤ãƒ³   â”‚
â”‚    [LINE OA Managerã‚’é–‹ã â†—]                â”‚
â”‚                                             â”‚
â”‚ 2. è¨­å®š â†’ Messaging API â†’ ã€ŒMessaging APIã‚’ â”‚
â”‚    åˆ©ç”¨ã™ã‚‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯                      â”‚
â”‚                                             â”‚
â”‚ 3. ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’é¸æŠã¾ãŸã¯æ–°è¦ä½œæˆ          â”‚
â”‚                                             â”‚
â”‚ [ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆç”»åƒ]                     â”‚
â”‚                                             â”‚
â”‚ å®Œäº†ã—ãŸã‚‰ â†’ [æ¬¡ã¸]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Step 3: èªè¨¼æƒ…å ±ã®å…¥åŠ›**
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: èªè¨¼æƒ…å ±ã‚’å…¥åŠ›                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ Channel Access Tokenï¼ˆé•·æœŸï¼‰                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ ğŸ“ å–å¾—å ´æ‰€: LINE Developers â†’ ãƒãƒ£ãƒãƒ« â†’   â”‚
â”‚    Messaging APIè¨­å®š â†’ ã€Œç™ºè¡Œã€ãƒœã‚¿ãƒ³       â”‚
â”‚    [LINE Developersã‚’é–‹ã â†—]                â”‚
â”‚                                             â”‚
â”‚ Channel Secret                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ ğŸ“ å–å¾—å ´æ‰€: ãƒãƒ£ãƒãƒ«åŸºæœ¬è¨­å®šã‚¿ãƒ–            â”‚
â”‚                                             â”‚
â”‚                              [æ¥ç¶šãƒ†ã‚¹ãƒˆ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Step 4: Webhookè¨­å®šï¼ˆè‡ªå‹•ã‚¬ã‚¤ãƒ‰ï¼‰**
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Webhookã‚’è¨­å®š                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ âœ… æ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸï¼                          â”‚
â”‚    LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€Œã€‡ã€‡åº—ã€ã‚’æ¤œå‡ºã—ã¾ã—ãŸ â”‚
â”‚                                             â”‚
â”‚ æœ€å¾Œã«ã€ä»¥ä¸‹ã®Webhook URLã‚’LINE Developersã« â”‚
â”‚ è¨­å®šã—ã¦ãã ã•ã„:                            â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ https://xxx.supabase.co/functions/v1/.. â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     [ã‚³ãƒ”ãƒ¼] â”‚
â”‚                                             â”‚
â”‚ è¨­å®šæ‰‹é †:                                   â”‚
â”‚ 1. LINE Developersã§ãƒãƒ£ãƒãƒ«ã‚’é–‹ã          â”‚
â”‚ 2. Messaging APIè¨­å®š â†’ Webhook URL ã«è²¼ä»˜   â”‚
â”‚ 3. ã€Œæ¤œè¨¼ã€ã‚’ã‚¯ãƒªãƒƒã‚¯                        â”‚
â”‚ 4. ã€ŒWebhookã®åˆ©ç”¨ã€ã‚’ONã«ã™ã‚‹              â”‚
â”‚                                             â”‚
â”‚ [LINE Developersã‚’é–‹ã â†—]                   â”‚
â”‚                                             â”‚
â”‚              [Webhookã‚’æ¤œè¨¼] [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æˆ¦ç•¥3: Webhookè‡ªå‹•æ¤œè¨¼æ©Ÿèƒ½

ã€ŒWebhookã‚’æ¤œè¨¼ã€ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã€ã‚µãƒ¼ãƒãƒ¼å´ã§å®Ÿéš›ã«WebhookãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª:

```typescript
// Edge Function: verify-line-webhook
// LINE APIã®Webhookæ¤œè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã—ã€
// è¨­å®šãŒæ­£ã—ã„ã‹ã‚’ãƒ†ã‚¹ãƒˆ
```

### æˆ¦ç•¥4: LIFFè¨­å®šã‚’ã€Œé«˜åº¦ãªè¨­å®šã€ã«ç§»å‹•

LIFFã¯å¤šãã®äº‹æ¥­è€…ã«ã¨ã£ã¦å¿…é ˆã§ã¯ãªã„ãŸã‚ã€åˆ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†é›¢:

```text
åŸºæœ¬è¨­å®šï¼ˆå¿…é ˆï¼‰
â”œâ”€â”€ Channel Access Token
â”œâ”€â”€ Channel Secret
â””â”€â”€ Webhook URL

é«˜åº¦ãªè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
â”œâ”€â”€ LIFF IDï¼ˆLINEã‹ã‚‰ã®äºˆç´„å±¥æ­´ç¢ºèªç”¨ï¼‰
â”œâ”€â”€ AIè‡ªå‹•å¿œç­”
â””â”€â”€ ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è¨­å®š
```

## å®Ÿè£…å†…å®¹

### 1. æ–°è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: LineSetupWizard.tsx

```typescript
// ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å½¢å¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—UI
// - 4ã‚¹ãƒ†ãƒƒãƒ—ã®ã‚¬ã‚¤ãƒ‰ä»˜ããƒ•ãƒ­ãƒ¼
// - å„ã‚¹ãƒ†ãƒƒãƒ—ã«èª¬æ˜ã¨ãƒªãƒ³ã‚¯
// - ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
// - æ¥ç¶šãƒ†ã‚¹ãƒˆçµ±åˆ
```

### 2. LineSettingsForm.tsx ã®ç°¡ç´ åŒ–

```typescript
// æ—¢å­˜è¨­å®šæ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘
// - å¿…é ˆé …ç›®ã®ã¿ä¸Šéƒ¨ã«è¡¨ç¤º
// - LIFF/AIè¨­å®šã¯æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«
// - ã€Œã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’é–‹ãã€ãƒœã‚¿ãƒ³è¿½åŠ 
```

### 3. UIã®æ”¹å–„ç‚¹

| æ”¹å–„é …ç›® | è©³ç´° |
|----------|------|
| ç›´æ¥ãƒªãƒ³ã‚¯ | LINE OA Managerã€LINE Developersã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯ |
| ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ | å„é …ç›®ã«ã€Œã©ã“ã§å–å¾—ï¼Ÿã€ã®èª¬æ˜è¿½åŠ  |
| è¦–è¦šçš„ã‚¬ã‚¤ãƒ‰ | ã‚¢ã‚¤ã‚³ãƒ³ãƒ»è‰²åˆ†ã‘ã§é‡è¦åº¦ã‚’æ˜ç¤º |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | è¨­å®šãƒŸã‚¹æ™‚ã®å…·ä½“çš„ãªå¯¾å‡¦æ³•ã‚’è¡¨ç¤º |

## æŠ€è¡“çš„ãªå®Ÿè£…

### LineSetupWizard.tsx æ§‹é€ 

```typescript
const LineSetupWizard = () => {
  const [step, setStep] = useState(1);
  const [hasOfficialAccount, setHasOfficialAccount] = useState<boolean | null>(null);
  
  return (
    <Dialog>
      <DialogContent className="max-w-2xl">
        {/* Progress indicator */}
        <StepIndicator currentStep={step} totalSteps={4} />
        
        {step === 1 && <Step1OfficialAccount onNext={() => setStep(2)} />}
        {step === 2 && <Step2MessagingAPI onNext={() => setStep(3)} />}
        {step === 3 && <Step3Credentials onNext={() => setStep(4)} />}
        {step === 4 && <Step4Webhook onComplete={handleComplete} />}
      </DialogContent>
    </Dialog>
  );
};
```

### å¤–éƒ¨ãƒªãƒ³ã‚¯ä¸€è¦§

| ãƒªãƒ³ã‚¯å…ˆ | URL |
|----------|-----|
| LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ | https://www.linebiz.com/jp/entry/ |
| LINE Official Account Manager | https://manager.line.biz/ |
| LINE Developers | https://developers.line.biz/console/ |

## æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

| æŒ‡æ¨™ | æ”¹å–„å‰ | æ”¹å–„å¾Œ |
|------|--------|--------|
| è¨­å®šå®Œäº†æ™‚é–“ | 30-60åˆ† | 10-15åˆ† |
| å¿…é ˆå…¥åŠ›é …ç›® | 6å€‹ | 2å€‹ |
| è¨­å®šãƒŸã‚¹ç‡ | é«˜ã„ | ä½ã„ï¼ˆã‚¬ã‚¤ãƒ‰ä»˜ãï¼‰ |
| ã‚µãƒãƒ¼ãƒˆå•ã„åˆã‚ã› | å¤šã„ | å°‘ãªã„ |

## å®Ÿè£…æ‰‹é †

1. `LineSetupWizard.tsx` ã‚’æ–°è¦ä½œæˆ
2. `LineSettingsForm.tsx` ã‚’ç°¡ç´ åŒ–ç‰ˆã«æ›´æ–°
3. æ—¢å­˜è¨­å®šè€…å‘ã‘ã®è¡¨ç¤ºã¨ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯è¿½åŠ 
4. ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆã¨å¤–éƒ¨ãƒªãƒ³ã‚¯ã®è¿½åŠ 
