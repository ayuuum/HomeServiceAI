

# 顧客詳細モーダルの追加

## 現状の構造

現在、顧客管理画面では以下のアクションボタンが分離しています：

```text
【現状】デスクトップ
┌──────┬──────┬──────┬──────┬──────┬──────┬─────────────────────┐
│ 名前 │ 電話 │メール│ 住所 │回数  │総額  │ [💬][📜][✏️][🗑️]   │
└──────┴──────┴──────┴──────┴──────┴──────┴─────────────────────┘
                                           ↑ 個別ボタン4つ

【現状】モバイル
┌────────────────────────────────┐
│ 名前          ¥50,000         │
│ 電話            5回利用       │
├───────────┬───────────┬───────┤
│   履歴   │   編集    │  💬  │  ← 3つのボタン
└───────────┴───────────┴───────┘
```

## 問題点
- 住所は一覧では省略表示され、詳細を確認しづらい
- 履歴と編集が別々のモーダルで、顧客の全体像が掴みにくい
- アクションボタンが多く、UIが煩雑

## 解決策

**「詳細を見る」ボタン**を追加し、顧客の総合情報を1つのモーダルで確認できるようにします。

```text
【改善後】デスクトップ
┌──────┬──────┬──────┬──────┬──────┬──────┬─────────────────────────────┐
│ 名前 │ 電話 │メール│ 住所 │回数  │総額  │ [詳細][💬][✏️][🗑️]          │
└──────┴──────┴──────┴──────┴──────┴──────┴─────────────────────────────┘
                                           ↑ 「詳細」がメインアクション

【改善後】モバイル - 行タップで詳細表示
┌────────────────────────────────┐
│ 名前          ¥50,000    [>] │  ← 行タップで詳細モーダル
│ 電話            5回利用       │
└────────────────────────────────┘
```

## 新規コンポーネント

### CustomerDetailModal
顧客の総合情報を表示する新しいモーダル

```text
┌─────────────────────────────────────────┐
│ 顧客詳細                           [×] │
├─────────────────────────────────────────┤
│                                         │
│  ◯ 山田太郎                            │
│                                         │
│  ────────────────────────────────────   │
│                                         │
│  📧 連絡先                             │
│  ┌─────────────────────────────────┐   │
│  │ 電話: 090-1234-5678             │   │
│  │ メール: yamada@example.com      │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📍 住所                               │
│  ┌─────────────────────────────────┐   │
│  │ 〒100-0001                      │   │
│  │ 東京都渋谷区渋谷1-1-1          │   │
│  │ ○○マンション 101号室           │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📊 利用状況                           │
│  ┌─────────────────────────────────┐   │
│  │ 利用回数: 5回                   │   │
│  │ 利用総額: ¥50,000              │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ────────────────────────────────────   │
│                                         │
│  📜 予約履歴（直近5件）               │
│  ┌─────────────────────────────────┐   │
│  │ 2024/01/15 エアコン清掃 ¥15,000│   │
│  │ 2023/12/20 キッチン清掃 ¥12,000│   │
│  │ ...                             │   │
│  │        [すべての履歴を見る]     │   │
│  └─────────────────────────────────┘   │
│                                         │
├─────────────────────────────────────────┤
│  [💬 LINEチャット]  [✏️ 編集]  [🗑️]   │
└─────────────────────────────────────────┘
```

## 変更ファイル

| ファイル | 変更内容 |
|----------|----------|
| `src/components/CustomerDetailModal.tsx` | **新規作成** - 顧客詳細モーダルコンポーネント |
| `src/pages/CustomerManagement.tsx` | 詳細モーダルの統合、UI構造の変更 |

## 変更詳細

### 1. CustomerDetailModal.tsx（新規作成）

```tsx
// 主な機能
- 顧客基本情報（名前、電話、メール）
- 住所情報（郵便番号、住所、建物名）
- 利用統計（利用回数、利用総額）
- 直近の予約履歴（5件）
- アクションボタン（LINE、編集、削除）
```

**Props:**
```tsx
interface CustomerDetailModalProps {
  customer: Customer | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onEdit: (customer: Customer) => void;
  onDelete: (customer: Customer) => void;
  onChat: (customer: Customer) => void;
  onViewAllHistory: (customer: Customer) => void;
}
```

### 2. CustomerManagement.tsx の変更

**状態追加:**
```tsx
const [viewingCustomer, setViewingCustomer] = useState<Customer | null>(null);
```

**モバイルカードレイアウト変更:**
- カード全体をタップ可能に
- ボタンを削除し、シンプルな矢印アイコンに

```tsx
// Before
<div className="p-4 space-y-3">
  <div>...</div>
  <div className="flex gap-2">
    <Button>履歴</Button>
    <Button>編集</Button>
    <Button>💬</Button>
  </div>
</div>

// After
<div 
  className="p-4 cursor-pointer hover:bg-muted/50"
  onClick={() => setViewingCustomer(customer)}
>
  <div className="flex items-center justify-between">
    <div>...</div>
    <Icon name="chevron_right" />
  </div>
</div>
```

**デスクトップテーブル変更:**
- 「詳細」ボタンを追加

```tsx
<Button onClick={() => setViewingCustomer(customer)}>
  <Icon name="visibility" /> 詳細
</Button>
```

## UI/UXの改善点

| 項目 | 変更前 | 変更後 |
|------|--------|--------|
| 住所確認 | テーブルで切り詰め表示 | モーダルで完全表示 |
| 履歴確認 | 別モーダルを開く | 詳細モーダル内で確認可能 |
| モバイル操作 | 3つのボタンをタップ | カードタップで詳細表示 |
| 情報の一覧性 | 分散した情報 | 1画面で全体像把握 |

## メリット

1. **情報の集約**: 顧客の全情報を1つのモーダルで確認
2. **操作の簡素化**: モバイルではタップ1回で詳細表示
3. **直近履歴の表示**: 別モーダルを開かずに履歴を確認可能
4. **一貫したUX**: BookingDetailModalと同様の設計パターン

