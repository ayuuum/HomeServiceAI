
# 予約管理カレンダーへの週間ビュー追加

## 概要
現在の月間カレンダーに加えて、週間カレンダービューを追加します。管理者は月間/週間を切り替えて、用途に応じた表示で予約を確認できるようになります。

## 現状と課題
- **現在**: 月間カレンダーのみ（5〜6週分を一覧表示）
- **課題**: 1日の予約詳細が見づらい、予約の時間帯ごとの分布が把握しにくい

## 改善案

### ビュー切り替え機能
月間ビューと週間ビューをタブまたはボタンで切り替え可能にします。

### 週間ビューのレイアウト

```text
┌──────────────────────────────────────────────────────────────────┐
│ ← 2025年1月 第4週 (1/20〜1/26) →                                  │
├────────┬────────┬────────┬────────┬────────┬────────┬────────────┤
│  時間  │ 月 20  │ 火 21  │ 水 22  │ 木 23  │ 金 24  │ 土 25     │
├────────┼────────┼────────┼────────┼────────┼────────┼────────────┤
│  9:00  │ 田中様 │        │ 山田様 │        │        │ 佐藤様    │
│        │ エアコン│        │ 水回り │        │        │ キッチン  │
├────────┼────────┼────────┼────────┼────────┼────────┼────────────┤
│ 10:00  │        │ 鈴木様 │        │ 高橋様 │        │           │
│        │        │ 浴室   │        │ 浴室   │        │           │
├────────┼────────┼────────┼────────┼────────┼────────┼────────────┤
│ 11:00  │        │        │        │        │ 伊藤様 │           │
└────────┴────────┴────────┴────────┴────────┴────────┴────────────┘
```

## 変更ファイル

| ファイル | 変更内容 |
|----------|----------|
| `src/pages/CalendarPage.tsx` | ビュー切り替えUI、週間ビューコンポーネントの追加 |

## 技術詳細

### 1. 状態管理の追加
```tsx
const [viewMode, setViewMode] = useState<"month" | "week">("month");
const [weekStart, setWeekStart] = useState(() => 
  startOfWeek(new Date(), { weekStartsOn: 1 })
);
```

### 2. ビュー切り替えUIの追加
```tsx
<div className="flex rounded-lg border bg-muted p-0.5">
  <Button 
    variant={viewMode === "month" ? "default" : "ghost"} 
    size="sm"
    onClick={() => setViewMode("month")}
  >
    月
  </Button>
  <Button 
    variant={viewMode === "week" ? "default" : "ghost"} 
    size="sm"
    onClick={() => setViewMode("week")}
  >
    週
  </Button>
</div>
```

### 3. 週間ビューコンポーネント
```tsx
{viewMode === "week" ? (
  <WeeklyCalendarView 
    weekStart={weekStart}
    bookings={bookings}
    onBookingClick={handleBookingClick}
    onWeekChange={setWeekStart}
    onDayClick={(day) => {
      setInitialBookingDate(day);
      setNewBookingModalOpen(true);
    }}
  />
) : (
  // 既存の月間カレンダー
)}
```

### 4. 週間グリッドの実装
- 縦軸: 営業時間帯（9:00〜18:00など）
- 横軸: 7日間
- セル: 該当時間の予約をカード形式で表示
- 予約カード: 顧客名、サービス名、ステータスバッジ

## 週間ビューの特徴

### メリット
1. **時間軸での把握**: スタッフの空き時間が一目でわかる
2. **予約の重複確認**: 同時間帯の予約を横並びで確認
3. **ドラッグ＆ドロップ対応準備**: 将来的な予約移動機能の土台

### UI要素
- **土曜日**: 薄い青背景（`bg-blue-50`）
- **日曜日**: 薄いピンク背景（`bg-pink-50`）
- **予約ステータス**: 確定（緑）、承認待ち（黄）、キャンセル（灰色）
- **現在時刻インジケーター**: 赤い横線で現在時刻を表示

## 既存機能との整合性
- 「今日の予約」セクションはそのまま維持
- クリックで予約詳細モーダルを開く動作は月間・週間で共通
- 空きセルクリックで新規予約モーダルを開く動作も共通

## 視覚的な比較

```text
【月間ビュー】概要把握向け
┌───┬───┬───┬───┬───┬───┬───┐
│ 日│ 月│ 火│ 水│ 木│ 金│ 土│
├───┼───┼───┼───┼───┼───┼───┤
│ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │
│3件│   │1件│2件│   │   │4件│ ← 件数のみ表示
└───┴───┴───┴───┴───┴───┴───┘

【週間ビュー】詳細確認向け
┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
│      │ 月20 │ 火21 │ 水22 │ 木23 │ 金24 │ 土25 │
├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
│ 9:00 │田中様│      │山田様│      │      │佐藤様│
│      │確定  │      │承認待│      │      │確定  │
├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
│10:00 │      │鈴木様│      │高橋様│      │      │
│      │      │確定  │      │確定  │      │      │
└──────┴──────┴──────┴──────┴──────┴──────┴──────┘
         ↑ 時間帯ごとの予約詳細が一目でわかる
```

## 実装の安全性
- 既存の月間カレンダーは完全に維持
- 新規追加のコンポーネントとして週間ビューを実装
- ローカルストレージでビュー設定を保存（ユーザーの好みを記憶）
