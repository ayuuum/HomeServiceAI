

# 包括的改善提案

コードベースを詳細に分析した結果、以下の4カテゴリで改善点を特定しました。

---

## 1. 管理画面のUX改善

### 1-1. ナビゲーション項目が多すぎる（8項目）

現在のヘッダーナビゲーションには8つの項目があり、デスクトップでも横幅を圧迫しています。

```text
現在: [ダッシュボード] [顧客管理] [予約管理] [受信トレイ] [一斉配信] [経営管理] [予約ページ↗] [設定]
```

**提案:** 「受信トレイ」と「一斉配信」を「メッセージ」に統合し、6項目に削減

```text
改善後: [ホーム] [顧客] [予約] [メッセージ] [レポート] [設定]
```

### 1-2. ダッシュボードのクイックアクション強化

現在のダッシュボードには「新規予約」ボタンのみ。よく使う操作をクイックアクションとして追加。

- 「予約ページURLをコピー」（現在は下にスクロールしないと見えない）
- 「LINEメッセージを確認」（未読件数バッジ付き）
- 「今日の売上確認」

### 1-3. BookingDetailModal の操作ボタンの整理

現在、承認待ちの予約に対して6個以上のボタンが並んでおり、特にモバイルでは混乱しやすい状態です。

**提案:** 主要アクション（承認/却下）を目立たせ、サブアクション（編集/リマインダー/キャンセル）はドロップダウンメニューにまとめる。

---

## 2. 顧客向け予約体験の改善

### 2-1. 予約完了後のフォローアップ画面

現在、予約完了後はモーダルのみ。完了後のページで以下を追加：

- Googleカレンダーに追加ボタン（顧客側）
- LINEの友だち追加QRコード表示
- 「予約内容をLINEで確認する」導線

### 2-2. 予約ページの読み込み体験

組織情報の読み込み中にスケルトンUIを表示し、ブランドカラーの適用をスムーズにする。

---

## 3. 業務効率化・自動化

### 3-1. 予約承認の一括処理

ダッシュボードの「要対応」セクションで、複数の予約を一括承認できる機能。朝の業務開始時に複数の新規予約をまとめて処理できる。

### 3-2. 自動承認モード

特定の条件を満たす予約を自動承認するオプション：
- 既存顧客（リピーター）の予約
- 特定の時間帯の予約
- 設定画面でON/OFF切り替え

### 3-3. 顧客情報の自動マージ

同一顧客が異なる名前・メールで予約した場合のマージ機能（現在 `fixMissingCustomers` で部分的に実装されているが、UIからの手動マージが未対応）。

---

## 4. 売上・成長戦略

### 4-1. リピーター割引の実装（計画済み）

メモリに記録されている `repeater-auto-discounts-plan` を実装：
- 2回目: 5%OFF
- 5回目: 10%OFF
- 10回目: 15%OFF
- 予約確認画面で自動表示

### 4-2. 顧客セグメント別のLINE自動フォロー

- 初回予約完了後: お礼メッセージ + レビュー依頼
- 30日以上未予約: 再来店促進メッセージ
- VIP顧客: 限定オファー配信

### 4-3. サービスアップセル機能

予約フォームの確認ステップで「おすすめオプション」を提案：
- 「他のお客様もよく追加しているオプション」
- 「セットで○○%お得」

---

## 推奨実装順序

| 順番 | 項目 | 理由 |
|------|------|------|
| 1 | ナビゲーション統合 (1-1) | 少ない変更で大きなUX改善 |
| 2 | BookingDetailModal整理 (1-3) | 毎日使う画面の操作性向上 |
| 3 | 自動承認モード (3-2) | 事業者の日常業務を大幅に削減 |
| 4 | リピーター割引 (4-1) | 既に計画済み、売上直結 |
| 5 | 予約完了後フォロー (2-1) | LINE友だち追加率向上 |
| 6 | 一括承認 (3-1) | 朝の業務効率化 |
| 7 | セグメント別自動フォロー (4-2) | リピート率向上の仕組み化 |

---

## 技術的な変更概要

### ナビゲーション統合 (1-1)
- `AdminHeader.tsx`: NavLink項目を6つに削減
- `MobileNav.tsx`: 同様に更新
- `InboxPage.tsx` に一斉配信タブを追加、または `/admin/messages` に統合ページ新設

### BookingDetailModal整理 (1-3)
- `BookingDetailModal.tsx`: サブアクションを `DropdownMenu` に移行

### 自動承認モード (3-2)
- `organizations` テーブルに `auto_approve_enabled`, `auto_approve_conditions` カラム追加
- 予約受付時のロジック（Edge Function or トリガー）に自動承認判定を追加
- `ProfilePage.tsx` の店舗設定に自動承認ON/OFFスイッチ追加

### リピーター割引 (4-1)
- 予約フォームの料金計算ロジックに顧客の予約回数に基づく割引を適用
- `organizations` テーブルに割引設定カラム追加
- 予約確認画面に割引表示を追加

